<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Record Count</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
  </style>
</head>
<body>
  <h1>Number of Records in the LastHeard Table</h1>
  <p id="record-count">Loading...</p>
  <p id="record-oldest">Loading...</p>
  <p id="record-newest">Loading...</p>

  <script>
    async function fetchRecordCount() {
      try {
        const count = await fetch('/record-count');
        const countData = await count.json();
        const oldest = await fetch('/record-oldest');
        const oldestData = await oldest.json();
        const newest = await fetch('/record-newest');
        const newestData = await newest.json();
        console.log(countData);

        document.getElementById('record-count').textContent = `There are ${countData.count} records currently in the LastHeard table`;
        document.getElementById('record-oldest').textContent = `The oldest record in the database is dated ${oldestData.oldest} UTC`;
        document.getElementById('record-newest').textContent = `The newest record in the database is dated ${newestData.newest} UTC`;
      } catch (error) {
        console.error('Error fetching record count:', error);
        document.getElementById('record-count').textContent = 'Error loading data';
      }
    }

    async function fetchRecordOldest() {
      try {
        const response = await fetch('/record-oldest');
        const data = await response.json();
        document.getElementById('record-oldest').textContent = `The oldest record in the database is dated ${data.oldest}`;
      } catch (error) {
        console.error('Error fetching oldest record:', error);
        document.getElementById('record-oldest').textContent = 'Error loading oldest record';
      }
    }

    async function fetchRecordNewest() {
      try {
        const response = await fetch('/record-newest');
        const data = await response.json();
        document.getElementById('record-newest').textContent = `The newest record in the database is dated ${data.newest}`;
      } catch (error) {
        console.error('Error fetching newest record:', error);
        document.getElementById('record-newest').textContent = 'Error loading newest record';
      }
    }

    // Fetch record count on page load
    fetchRecordCount();

    // Refresh the page every 5 seconds
    setInterval(fetchRecordCount, 5000);
  </script>
</body>
<footer>
  <p>
      This website is provided by Volker Kerkhoff, 41089 Dos Hermanas (Spain). We do not use cookies, neither own or third-party. This application does not track you and does not use any personal data that isn't already publicly available. The complete source code is available on <a href="https://github.com/ea7klk/bm-lastheard-node" target="_blank">GitHub</a> and is under Creative Commons license. Please contact me via GitHub issues or volker at ea7klk . es
  </p>
</footer>
</html>